{% extends 'base.html' %}
{% load static %}

{% block title %}Vista Previa - {{ plantilla.nombre }} - PRCE{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/simulaciones.css' %}">
<style>
    .email-preview {
        background: #f5f5f5;
        padding: 20px;
        max-width: 800px;
        margin: 0 auto;
    }
    .email-container {
        background: white;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-4 mb-5">
    <h2 class="text-center mb-4">üëÅÔ∏è Vista Previa de Plantilla</h2>
    
    <div class="email-preview">
        <div class="email-container">
            <!-- Header -->
            <div class="mb-4 pb-3 border-bottom">
                <h5 class="text-muted mb-1">De: sistema@eventos.com</h5>
                <h5 class="text-muted mb-1">Para: {{ contexto.nombre }}</h5>
                <h4 class="mt-3"><strong>Asunto:</strong> {{ asunto }}</h4>
            </div>

            <!-- Body -->
            <div class="email-body">
                {% if cuerpo_html %}
                    {{ cuerpo_html|safe }}
                {% else %}
                    <pre style="white-space: pre-wrap; font-family: Arial, sans-serif;">{{ cuerpo_texto }}</pre>
                {% endif %}
            </div>

            <!-- Footer -->
            <div class="mt-4 pt-3 border-top text-muted">
                <small>
                    Esta es una vista previa generada con datos de ejemplo.<br>
                    Plantilla: <strong>{{ plantilla.nombre }}</strong><br>
                    Tipo: <strong>{{ plantilla.tipo_notificacion.nombre }}</strong>
                </small>
            </div>
        </div>
    </div>

    <!-- Contexto de Ejemplo -->
    <div class="card mt-4" style="max-width: 800px; margin: 20px auto;">
        <div class="card-header">
            <h5 class="mb-0">Datos de Ejemplo Utilizados</h5>
        </div>
        <div class="card-body">
            <pre>{{ contexto|pprint }}</pre>
        </div>
    </div>

    <!-- Acciones -->
    <div class="text-center mt-4">
        <a href="{% url 'notificaciones:editar_plantilla' plantilla.id %}" class="btn btn-primary">
            <i class="fas fa-edit"></i> Editar Plantilla
        </a>
        <a href="{% url 'notificaciones:plantillas' %}" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left"></i> Volver a Plantillas
        </a>
        <button onclick="window.print()" class="btn btn-outline-info">
            <i class="fas fa-print"></i> Imprimir
        </button>
    </div>
</div>
{% endblock %}
